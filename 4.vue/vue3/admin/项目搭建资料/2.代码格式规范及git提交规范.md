## è§£å†³[ä»£ç å¯è¯»æ€§ä½]çš„é—®é¢˜ æ–¹ä¾¿å¤šäººåˆä½œ æå‡å¼€å‘æ•ˆç‡ æé«˜ä»£ç è´¨é‡

- è½åœ°ä»£ç è§„èŒƒ
- ç»Ÿä¸€ä»£ç æ ¼å¼
- æé«˜ä»£ç è´¨é‡

# ä»£ç æ ¼å¼è§„èŒƒ
ä¸»è¦åŒ…æ‹¬å…­ä¸ªéƒ¨åˆ†
- ç»Ÿä¸€å‰ç«¯ç¼–è¾‘å™¨: vscode
- ç»Ÿä¸€å›¢é˜Ÿvscodeç¼–è¾‘å™¨é»˜è®¤é…ç½®: editorConfig
- è‡ªåŠ¨æ ¼å¼åŒ–ä»£ç ï¼šPrettier
- æ£€æŸ¥ä»£ç è¯­æ³•è§„èŒƒ&é”™è¯¯: ESLint
- cssç¼–ç é£æ ¼ä¸€è‡´&æ£€æŸ¥: StyleLint
- ä¼˜åŒ–æ£€æµ‹é€Ÿåº¦ï¼šLintStaged

## ç»Ÿä¸€å‰ç«¯ç¼–è¾‘å™¨
éœ€è¦è®©å›¢é˜Ÿæˆå‘˜éƒ½ä½¿ç”¨**vscode**ä½œä¸ºç¼–è¾‘å™¨

## ç»Ÿä¸€ç¼–è¾‘å™¨é»˜è®¤é…ç½®
å®‰è£…**EditorConfig for VS Code**æ’ä»¶
é¡¹ç›®æ ¹ç›®å½•ä¸‹æ–°å»º.editorconfigæ–‡ä»¶
é…ç½®å¦‚ä¸‹
```bash
root = true # æ§åˆ¶é…ç½®æ–‡ä»¶ .editorconfig æ˜¯å¦ç”Ÿæ•ˆçš„å­—æ®µ

[**] # åŒ¹é…å…¨éƒ¨æ–‡ä»¶
charset = utf-8 # è®¾ç½®å­—ç¬¦é›†
indent_style = tab # ç¼©è¿›é£æ ¼ï¼Œå¯é€‰spaceï½œtab
indent_size = 2 # ç¼©è¿›çš„ç©ºæ ¼æ•°
trim_trailing_whitespace = true # ä¿å­˜æ—¶åˆ é™¤è¡Œå°¾ç©ºæ ¼
insert_final_newline = true # ä¿å­˜æ—¶ä¼šåœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ ç©ºç™½è¡Œç»“å°¾
end_of_line = lf # æ¢è¡Œç¬¦ç±»å‹ = lf

[*.md] # åŒ¹é…markdownæ–‡ä»¶
trim_trailing_whitespace = false # åˆ é™¤è¡Œå°¾ç©ºæ ¼ = å¦
```

## é…ç½® Prettier

- æ¯ä¸ªäººå†™ä»£ç çš„é£æ ¼ä¹ æƒ¯ä¸ä¸€æ ·ï¼Œæ¯”å¦‚ä»£ç æ¢è¡Œã€ç»“å°¾æ˜¯å¦å¸¦åˆ†å·ã€å•åŒå¼•ã€ç¼©è¿›ç­‰ï¼Œè€Œä¸”ä¸èƒ½åªé å£å¤´è§„èŒƒæ¥çº¦æŸï¼Œé¡¹ç›®ç´§æ€¥çš„æ—¶å€™å¯èƒ½ä¼šä¸å¤ªæ³¨æ„ä»£ç æ ¼å¼ï¼Œè¿™æ—¶å€™éœ€è¦æœ‰å·¥å…·æ¥å¸®æˆ‘ä»¬è‡ªåŠ¨æ ¼å¼åŒ–ä»£ç 
- å®˜æ–¹æ–‡æ¡£ï¼š[Prettier ä¸­æ–‡ç½‘ Â· Prettier æ˜¯ä¸€ä¸ªâ€œæœ‰æ€åº¦â€çš„ä»£ç æ ¼å¼åŒ–å·¥å…·](https://www.prettier.cn/)

### å®‰è£…ä¾èµ–

```bash
pnpm add prettier  -D
```

#### æ·»åŠ é…ç½®æ–‡ä»¶

- Prettier é…ç½®æ–‡ä»¶åç§°å¯ä»¥ä¸ºï¼š.ptettierrc.jsã€.ptettier.config.js ï¼ˆæ ¹æ®ä¸ªäººä¹ æƒ¯é€‰æ‹©å³å¯ï¼‰
- é…ç½®è§„åˆ™å¯å‚è€ƒğŸ‘‡ğŸ»ï¼Œæ›´å¤šé…ç½®è§„åˆ™å¯ä»¥å‰å®˜ç½‘æŸ¥çœ‹ï¼š[Options Â· Prettier ä¸­æ–‡ç½‘](https://www.prettier.cn/docs/options.html)

```javascript
module.exports = {
	printWidth: 120, // ä¸€è¡Œçš„å­—ç¬¦æ•°ï¼Œå¦‚æœè¶…è¿‡ä¼šè¿›è¡Œæ¢è¡Œ
	tabWidth: 2, // ä¸€ä¸ªtabä»£è¡¨å‡ ä¸ªç©ºæ ¼æ•°ï¼Œé»˜è®¤å°±æ˜¯2
	useTabs: true, // æ˜¯å¦å¯ç”¨tabå–ä»£ç©ºæ ¼ç¬¦ç¼©è¿›ï¼Œ.editorconfigè®¾ç½®tabç¼©è¿›ï¼Œæ‰€ä»¥è®¾ç½®ä¸ºtrue
	semi: true, // è¡Œå°¾æ˜¯å¦ä½¿ç”¨åˆ†å·ï¼Œé»˜è®¤ä¸ºtrue
	singleQuote: true, // å­—ç¬¦ä¸²æ˜¯å¦ä½¿ç”¨å•å¼•å·
	bracketSpacing: true, // å¯¹è±¡å¤§æ‹¬å·ç›´æ¥æ˜¯å¦æœ‰ç©ºæ ¼ï¼Œé»˜è®¤ä¸ºtrueï¼Œæ•ˆæœï¼š{ foo: bar }
	arrowParens: 'avoid', // ç®­å¤´å‡½æ•°å¦‚æœåªæœ‰ä¸€ä¸ªå‚æ•°åˆ™çœç•¥æ‹¬å·
	trailingComma: 'none' // å¯¹è±¡æˆ–æ•°ç»„æœ«å°¾æ˜¯å¦æ·»åŠ é€—å· none| es5| all
};
```
#### é¡¹ç›®ä¸­ä½¿ç”¨Prettier

é…ç½®ä¸€ä¸ªæŒ‡ä»¤ä¾¿äºæˆ‘ä»¬ä½¿ç”¨ prettier è¿›è¡Œä¿®å¤ä»£ç é£æ ¼

```json
{
	"script": {
		"lint:prettier": "prettier --write **/*.{js,json,tsx,css,less,scss,vue,html,md}"
	}
}
```

#### ç¼–è¾‘å™¨ä¸­ä½¿ç”¨Prettier

**å®‰è£…[Prettier]æ’ä»¶**
å®‰è£…å Prettierä¼šè‡ªåŠ¨åœ¨ä¿å­˜æ–‡ä»¶çš„æ—¶å€™æ ¼å¼åŒ–ä»£ç 

#### é…ç½®å¿½ç•¥æ–‡ä»¶

æˆ‘ä»¬è¿˜å¯ä»¥é…ç½®å¿½ç•¥æ–‡ä»¶ï¼Œè®© Prettier ä¸å¯¹è¿™äº›æ–‡ä»¶è¿›è¡Œæ ¡éªŒã€‚
æ–°å»º .prettierignore è¿›è¡Œé…ç½®ã€‚

```bash
/dist/*
/node_modules/**
```

## é…ç½® ESLint
- ä»£ç è´¨é‡æ£€æµ‹ï¼Œæ£€æŸ¥è¯­æ³•æ˜¯å¦æœ‰é—®é¢˜ æœ‰æ²¡æœ‰å®šä¹‰ä½†æœªä½¿ç”¨çš„å˜é‡ æœ‰æ²¡æœ‰æ­»å¾ªç¯ç­‰ã€‚é¿å…ä½çº§é”™è¯¯&ç»Ÿä¸€ä»£ç é£æ ¼
- éƒ¨åˆ†æ ¼å¼ç¾åŒ–å·¥ä½œ
- ESLint å®˜æ–¹æ–‡æ¡£ï¼š[ESLint - Pluggable JavaScript linter - ESLint ä¸­æ–‡](https://eslint.cn/)

#### å®‰è£…ä¾èµ–

```bash
pnpm add eslint @eslint/create-config -D
```

- @eslint/create-configï¼šeslint é…ç½®æ–‡ä»¶åˆå§‹åŒ–å·¥å…·

#### ç”Ÿæˆé…ç½®æ–‡ä»¶

```bash
#  ç”Ÿæˆ ESLint é…ç½®æ–‡ä»¶æ¨¡æ¿
npx eslint --init
```

```bash
# å‡ºç°å¦‚ä¸‹é€‰æ‹©

# é€‰æ‹©2 æˆ‘ä»¬ä¼šä½¿ç”¨ prettier è¿›è¡Œä»£ç é£æ ¼æ ¡éªŒ
How would you like to use ESLint?
1.åªæ£€æŸ¥è¯­æ³•
2.æ£€æŸ¥è¯­æ³•å¹¶æç¤ºé—®é¢˜
3.æ£€æŸ¥è¯­æ³•ã€æç¤ºé—®é¢˜å¹¶ä¸”å¼ºåˆ¶ä½¿ç”¨ä¸€äº›ä»£ç é£æ ¼

# ä½ çš„é¡¹ç›®ç”¨çš„å“ªä¸€ç§æ¨¡å—åŒ–æ–¹å¼ é€‰æ‹©1
What type of modules does your project use?
1.ES6
2.CommonJS
3.None

# ä½¿ç”¨çš„æ¡†æ¶ é€‰æ‹©2
Which framework does your project use?
1.React
2.Vue.js
3.None

# é¡¹ç›®æ˜¯å¦ä½¿ç”¨TS yes
Does your project use TypeScript?

# é¡¹ç›®åœ¨å“ªé‡Œè·‘çš„ é€‰æ‹©1
Where does your code run?
1.browser
2.node

# é¡¹ç›®ç”¨å“ªç§é…ç½®æ–‡ä»¶ é€‰æ‹©1
What format do you want your config file to be in?
1.JavaScript
2.YAML
3.JSON

# æ˜¯å¦ç«‹å³å®‰è£…éœ€è¦çš„ä¾èµ–
Would you like to install them now?

# ä¼šå¸®æˆ‘ä»¬å®‰è£…å¦‚ä¸‹æ’ä»¶
# pnpm add eslint-plugin-vue@latest @typescript-eslint/eslint-plugin@latest @typescript-eslint/parser@latest -D
```

- ç†Ÿæ‚‰ä¹‹åæˆ‘ä»¬å°±å¯ä»¥ä¸ä½¿ç”¨é…ç½®ç”Ÿæˆå·¥å…·ï¼Œç›´æ¥æ–°å»ºé…ç½®æ–‡ä»¶è¿›è¡Œé…ç½®å³å¯
- ESLint é…ç½®æ–‡ä»¶åç§°å¯ä»¥ä¸ºï¼š.eslintrc.jsã€.eslint.config.js ï¼ˆæ ¹æ®ä¸ªäººä¹ æƒ¯é€‰æ‹©å³å¯ï¼‰

é…ç½®è§„åˆ™å¯å‚è€ƒğŸ‘‡ğŸ»ï¼Œæ›´å¤šé…ç½®è§„åˆ™è¯·æŸ¥é˜…[ESLint ä¸­æ–‡](https://eslint.cn/)ã€‚
å•ç‹¬çš„è¯­æ³•é…ç½®éœ€è¦åœ¨ rules ä¸­ç¼–å†™ï¼Œå…¨éƒ¨é…ç½®è¯·å‚è€ƒï¼š[List of available rules - ESLint ä¸­æ–‡](https://eslint.cn/docs/rules/)

```javascript
module.exports = {
	// å‘ä¸ŠæŸ¥æ‰¾eslinté…ç½®æ—¶ï¼Œrootä¸ºtrueä¸å†ç»§ç»­å¾€ä¸ŠæŸ¥æ‰¾
	root: true,
	// æŒ‡å®šè„šæœ¬çš„è¿è¡Œç¯å¢ƒ
	env: {
		browser: true,
		es2024: true,
		node: true
	},
	// æ ¹æ®æŒ‡å®šçš„è§„èŒƒå»æ£€æŸ¥æŒ‡å®šç±»å‹çš„æ–‡ä»¶
	extends: [
		'eslint:recommended', // æ£€æŸ¥jsä»£ç 
		'plugin:vue/vue3-recommended', // æ£€æŸ¥vue3ä»£ç 
		'plugin:@typescript-eslint/recommended', // æ£€æŸ¥tsä»£ç 
		// å…³é—­eslintä¸­ä¸prettierç›¸äº’å†²çªçš„è§„åˆ™ï¼Œèµ‹äºˆeslintç”¨prettieræ ¼å¼åŒ–ä»£ç çš„èƒ½åŠ›
		// pnpm add eslint-config-prettier eslint-plugin-prettier -D [eslint-config-prettier çš„ä½œç”¨æ˜¯å…³é—­ eslint ä¸­ä¸ prettier ç›¸äº’å†²çªçš„è§„åˆ™][eslint-plugin-prettier çš„ä½œç”¨æ˜¯èµ‹äºˆ eslint ç”¨ prettier æ ¼å¼åŒ–ä»£ç çš„èƒ½åŠ›]
		'plugin:prettier/recommended'
	],
	// è¿™é‡Œä¸€å®šè¦é…ç½®å¯¹ [å…ˆä½¿ç”¨vue-eslint-parser å†ä½¿ç”¨@typescript-eslint/parser] [å…ˆè§£æ <template> æ ‡ç­¾ä¸­çš„å†…å®¹ ç„¶åå†è§£æ vue <script> æ ‡ç­¾ä¸­çš„ TS ä»£ç ]
	// é€‰æ‹©ä½¿ç”¨çš„è§£æå™¨
	parser: 'vue-eslint-parser',
	// è§£æå™¨é€‰é¡¹ã€‚æŒ‡å®šä½ æƒ³æ”¯æŒçš„è¯­è¨€ï¼Œé»˜è®¤æ”¯æŒes5ã€‚æŒ‡å®šå•¥è¯­è¨€ï¼Œeslintå°±æŒ‰ç…§å•¥è¯­æ³•æ£€æŸ¥ã€‚
	parserOptions: {
		// ä½¿ç”¨æœ€æ–°ç‰ˆ ES è¯­æ³•
		ecmaVersion: 'latest',
		// ä½¿ç”¨ ESLint TS è§£æå™¨
		parser: '@typescript-eslint/parser',
		// ä½¿ç”¨ ES æ¨¡å—åŒ–è§„èŒƒ
		sourceType: 'module'
	},
	// eslintè§„åˆ™
	// [off|0] å…³é—­è§„åˆ™
	// [warn|1] å¯ç”¨å¹¶è§†ä½œè­¦å‘Š
	// [error|2] å¯ç”¨å¹¶è§†ä½œé”™è¯¯
	rules: {}
};
```

#### é¡¹ç›®ä¸­ä½¿ç”¨ESLint
package.json scripts ä¸­æ·»åŠ ä¸€æ¡å‘½ä»¤
```json
"scripts": {
  "lint:eslint": "eslint \"./{src,mock}/**/*.{ts,js,vue}\"",
},
```

#### ç¼–è¾‘å™¨ä¸­ä½¿ç”¨ESLint
**å®‰è£…[ESLint]æ’ä»¶**
ä½¿ç”¨ç¼–è¾‘å™¨çš„ESLintæ’ä»¶ å¯ä»¥å†ç¼–ç è¿‡ç¨‹ä¸­å®æ—¶å‘ç°ä¸ç¬¦åˆè§„èŒƒçš„ä»£ç å¹¶åŠæ—¶æ”¹æ­£ï¼Œæå‡ç¼–ç æ•ˆç‡

vscode-eslint ä¼˜å…ˆä½¿ç”¨å®‰è£…åœ¨å½“å‰é¡¹ç›®ä¸­çš„ npm ESLint
å¦‚æœå½“å‰é¡¹ç›®ä¸­æ²¡æœ‰æä¾›ï¼Œå®ƒä¼šä½¿ç”¨å…¨å±€å®‰è£…çš„ npm ESLint
ç„¶åçœ‹æ˜¯å¦å­˜åœ¨ ESLint é…ç½®æ–‡ä»¶
å¦‚æœæ²¡æœ‰çš„è¯å°±ä¸ä¼šå»æ ¡éªŒ
æœ‰çš„è¯å¦‚æœå¾…æ ¡éªŒçš„æ–‡ä»¶å±äº "eslint.validate" æˆ–è€…å±äº "eslint.probe" ä¸”æ¢æµ‹æˆåŠŸï¼Œå¼€å§‹ ESLint æ ¡éªŒã€‚

#### é…ç½®å¿½ç•¥æ–‡ä»¶
æˆ‘ä»¬è¿˜å¯ä»¥é…ç½®å¿½ç•¥æ–‡ä»¶ï¼Œè®© ESLint ä¸å¯¹è¿™äº›æ–‡ä»¶è¿›è¡Œæ ¡éªŒã€‚
æ–°å»º .eslintignore è¿›è¡Œé…ç½®ã€‚

```json
node_modules
*.md
.vscode
.idea
dist
/public
/docs
.husky
.local
/bin
```

## é…ç½® StyleLint

- StyleLint æ˜¯ä¸€ä¸ªå¼ºå¤§ã€å…ˆè¿›çš„ CSS ä»£ç æ£€æŸ¥å™¨ï¼ˆlinterï¼‰ï¼Œå¯ä»¥å¸®åŠ©ä½ è§„é¿ CSS ä»£ç ä¸­çš„é”™è¯¯å¹¶ä¿æŒä¸€è‡´çš„ç¼–ç é£æ ¼ã€‚
- éƒ¨åˆ†æ ¼å¼ç¾åŒ–å·¥ä½œ
- StyleLint å®˜æ–¹æ–‡æ¡£ï¼š[Home | Stylelintä¸­æ–‡æ–‡æ¡£](https://stylelint.bootcss.com/index.html)

#### å®‰è£…ä¾èµ–

#### æ·»åŠ é…ç½®æ–‡ä»¶

- StyleLint é…ç½®æ–‡ä»¶åç§°å¯ä»¥ä¸ºï¼š.stylelintrc.jsã€.stylelint.config.js ï¼ˆæ ¹æ®ä¸ªäººä¹ æƒ¯é€‰æ‹©å³å¯ï¼‰
- æ›´å¤šè¯¦ç»†é…ç½®è§„åˆ™è¯·æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£ï¼š[List of rules | Stylelint ä¸­æ–‡æ–‡æ¡£ (bootcss.com)](https://stylelint.bootcss.com/user-guide/rules/list)

```javascript
module.exports = {
};
```

#### é¡¹ç›®ä¸­ä½¿ç”¨StyleLint

#### ç¼–è¾‘å™¨ä¸­ä½¿ç”¨StyleLint

#### é…ç½®å¿½ç•¥æ–‡ä»¶

## é…ç½®LintStaged

- åœ¨æäº¤ä»£ç ä¹‹å‰ï¼Œå¯ä»¥å†ä½¿ç”¨å‘½ä»¤è¡Œæ£€æŸ¥ä¸€ä¸‹ä»£ç æ˜¯å¦ç¬¦åˆè§„èŒƒï¼Œæ£€æŸ¥å…¨é‡ä»£ç å¤ªè¿‡è€—æ—¶ï¼Œå¯ä»¥ä½¿ç”¨lint-stagezåªæ£€æŸ¥æš‚å­˜åŒºçš„ä»£ç 

#### å®‰è£…ä¾èµ–

```bash
pnpm add lint-staged -D
```

#### é…ç½®

åœ¨ package.json é…ç½®ä¸€ä¸ªæŒ‡ä»¤
åŒæ—¶é…ç½®lint-stagedæ£€æµ‹ç›¸å…³å†…å®¹

```json
{
	"script": {
		"lint:lint-staged": "lint-staged"
	}
	"lint-staged": {
		"*.{js,jsx,ts,tsx}": [
			"pnpm run lint:prettier",
			"pnpm run lint:eslint"
		],
		"{!(package)*.json,*.code-snippets,.!(browserslist)*rc}": [
			"pnpm run lint:prettier"
		],
		"package.json": [
			"pnpm run lint:prettier"
		],
		"*.vue": [
			"pnpm run lint:prettier",
			"pnpm run lint:eslint"
		],
		"*.{scss,less,styl,html}": [
			"pnpm run lint:prettier"
		],
		"*.md": [
			"pnpm run lint:prettier"
		]
	},
}
```
# Gitæäº¤è§„èŒƒ

## é…ç½® Husky

- å›¢é˜Ÿåä½œæ—¶ï¼Œæˆ‘ä»¬ä¼šé‡åˆ°å¤šç§é—®é¢˜ï¼Œæœ€è®©äººéš¾å—çš„å°±æ˜¯æ¯ä¸ªäººä¹¦å†™çš„ä»£ç é£æ ¼ä¸ä¸€è‡´ ğŸ˜…ï¼Œä½¿ç”¨çš„è§„èŒƒä¸ä¸€è‡´ï¼Œå¯¼è‡´å›¢é˜Ÿåä½œæ•ˆç‡æä½ï¼Œä»£ç å¯è¯»æ€§å·®ã€‚
- è¿™æ—¶å€™å°±éœ€è¦ Husky æ¥å¸®å¿™äº†ï¼Œå®ƒå¯ä»¥å¸®åŠ©æˆ‘ä»¬åœ¨ä»£ç æäº¤å‰åè¿›è¡Œä¸€äº›è‡ªå®šä¹‰çš„æ“ä½œï¼Œåƒæ˜¯ä»£ç é£æ ¼çš„æ ¡éªŒï¼Œå¹¶ä¸”å®ƒæ”¯æŒæ‰€æœ‰çš„ Git é’©å­ï¼ˆé’©å­æ˜¯ä½ å¯ä»¥æ”¾åœ¨é’©å­ç›®å½•ä¸­è§¦å‘çš„ç¨‹åº åœ¨ Git æ‰§è¡Œçš„æŸäº›ç‚¹æ‰§è¡Œçš„æ“ä½œï¼‰ã€‚

Git å…¨éƒ¨é’©å­çš„è¯¦ç»†ä»‹ç»ï¼š[Git - githooks Documentation (git-scm.com)](https://git-scm.com/docs/githooks)
**æœ¬æ–‡ç”¨åˆ°çš„é’©å­**ï¼š

- åœ¨ pre-commit è§¦å‘æ—¶è¿›è¡Œä»£ç æ ¼å¼éªŒè¯ï¼Œåœ¨ commit-msg è§¦å‘æ—¶å¯¹ commit æ¶ˆæ¯å’Œæäº¤ç”¨æˆ·è¿›è¡ŒéªŒè¯ã€‚
  | git hook | æ‰§è¡Œæ—¶æœŸ | å¤‡æ³¨ |
  | --- | --- | --- |
  | pre-commit | git commit æ‰§è¡Œå‰ | git commit --no verify å‘½ä»¤å¯ä»¥ç»•è¿‡è¯¥é’©å­ |
  | commit-msg | git commit æ‰§è¡Œå‰ | git commit --no verify å‘½ä»¤å¯ä»¥ç»•è¿‡è¯¥é’©å­ |

### å®‰è£…ä¾èµ–

```bash
pnpm add husky -D
```

æ­¤å¤„ä½¿ç”¨husky 9.0.11ç‰ˆæœ¬

ç„¶åé…ç½®ä¸€ä¸ªåˆå§‹åŒ– Hysky çš„å‘½ä»¤

```json
// package.json
{
	"script": {
		"prepare": "husky"
	}
}
```

è¿è¡Œè¿™ä¸ªå‘½ä»¤

```bash
# è¿è¡Œåä¼šåˆå§‹åŒ–husky
pnpm run prepare
```

è¿è¡Œä¹‹åå°±ä¼šå‡ºç°.husky æ–‡ä»¶å¤¹ï¼Œä¹‹åæˆ‘ä»¬å°±å¯ä»¥é…ç½®åœ¨ GItHook ä¸­æ‰§è¡Œçš„æ“ä½œå•¦ ğŸ˜€ã€‚

## é…ç½® LintStaged

- æœ‰äº›åŒå­¦æ„Ÿè§‰ä½¿ç”¨ IDE çš„ä¿å­˜è‡ªåŠ¨ä¿®å¤ç›¸å½“éº»çƒ¦ï¼Œæˆ‘æ¯æ¬¡æ”¹å®Œä¹‹åéƒ½éœ€è¦ç­‰ä»–ä¿®å¤ä¸€ä¸‹ ğŸ˜¡ï¼Œå¤ªä¸æ–¹ä¾¿å•¦ï¼
- æ¥ä¸‹æ¥å°±è¦è¯·å‡ºæˆ‘ä»¬çš„å¥½å¸®æ‰‹ï¼šlint-stagedï¼Œå®ƒå¯ä»¥å¸®åŠ©æˆ‘ä»¬åœ¨ git ç¼“å­˜ä¸­è¿›è¡Œä»£ç è´¨é‡ä¸é£æ ¼çš„ä¿®å¤ï¼Œåœ¨ä»£ç æäº¤å‰è¿›è¡Œç»Ÿä¸€æ ¡éªŒï¼Œé€šè¿‡åæ‰å¯ä»¥æäº¤ã€‚

### å®‰è£…ä¾èµ–

```bash
pnpm add lint-staged -D
```

### é…ç½®

åœ¨ package.json é…ç½®ä¸€ä¸ªæŒ‡ä»¤æ–¹ä¾¿æˆ‘ä»¬ä½¿ç”¨

```json
{
	"script": {
		"lint:lint-staged": "lint-staged"
	}
}
```

ä½¿ç”¨ husky é…ç½®ä¸€ä¸ª pre-commit é’©å­

```sql
# .huskyä¸‹æ–°å»ºpre-commitæ–‡ä»¶ å¾€é‡Œé¢åŠ å…¥
pnpm run lint:lint-staged
```

LintStaged çš„é…ç½®æ–‡ä»¶æ–¹å¼ä¹Ÿæœ‰å¤šç§ï¼š

- åœ¨ package.json ä¸­é…ç½®
- lint-staged.js æˆ– lint-staged.config.js
- .lintstagedrc.json æˆ– .lintstagedrc.yaml

è¿™é‡Œæˆ‘ä»¬ç›´æ¥åœ¨ package.json ä¸­é…ç½®

```json
// æˆ‘ä»¬ç›´æ¥é…ç½®åœ¨ package.json ä¸­
/*
é…ç½®çš„å«ä¹‰ï¼š
<éœ€è¦æ‰§è¡Œçš„æ–‡ä»¶>: <å¯¹åº”æ–‡ä»¶éœ€è¦æ‰§è¡Œçš„å‘½ä»¤æ•°ç»„>
*/
"lint-staged": {
  "*.{js,jsx,ts,tsx}": [
    "eslint --fix",
    "prettier --write"
  ],
  "{!(package)*.json,*.code-snippets,.!(browserslist)*rc}": [
    "prettier --write--parser json"
  ],
  "package.json": [
    "prettier --write"
  ],
  "*.vue": [
    "eslint --fix",
    "prettier --write",
    "stylelint --fix"
  ],
  "*.{scss,less,styl,html}": [
    "stylelint --fix",
    "prettier --write"
  ],
  "*.md": [
    "prettier --write"
  ]
}
```

è¿™æ ·å°±é…ç½®å®Œæ¯•å•¦ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨ git commit -am "xxx" æ—¶ï¼Œlint-staged ä¼šè‡ªåŠ¨æ‰§è¡Œå¸®æˆ‘ä»¬è¿›è¡Œä»£ç è´¨é‡ä¸é£æ ¼çš„ä¿®å¤ã€‚

## é…ç½® CommitLint

- æ¯æ¬¡çœ‹ Github ä»“åº“çš„æ—¶å€™ï¼Œæ€»æ„Ÿè§‰æœ‰äº›ä¸é¡ºçœ¼ã€‚åŸæ¥æ˜¯æäº¤é™„å¸¦çš„ä¿¡æ¯ä¹±ç³Ÿç³Ÿçš„ï¼Œéƒ½æ˜¯"æ–°å¢ xx åŠŸèƒ½"ï¼Œ"ä¿®å¤ xxBUG"ï¼Œéå¸¸çš„ä¸å·¥æ•´ï¼Œçœ‹ç€å¤ªä¸èˆ’æœå•¦ ğŸ¤¯ã€‚
- ä¸è¦æ…Œï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ CommitLint å¯¹æäº¤çš„ä¿¡æ¯è¿›è¡Œè§„èŒƒã€‚
- å®˜æ–¹æ–‡æ¡£ï¼š[commitlint - Lint commit messages](https://commitlint.js.org/#/)

### å®‰è£…ä¾èµ–

```bash
pnpm add @commitlint/cli  @commitlint/config-conventional  -D
```

- @commitlint/config-conventionalï¼šcommitlint è‡ªå®šä¹‰é…ç½®è§„åˆ™æ’ä»¶

### é…ç½®

#### è§„åˆ™é…ç½®

- CommitLint é…ç½®æ–‡ä»¶åç§°å¯ä»¥ä¸ºï¼š.commitlintrc.jsã€.commitlint.config.js ï¼ˆæ ¹æ®ä¸ªäººä¹ æƒ¯é€‰æ‹©å³å¯ï¼‰

**é…ç½®æ–‡ä»¶å†…å®¹å¦‚ä¸‹**

- å®˜æ–¹æ–‡æ¡£çš„é…ç½®è§„åˆ™è®²è§£ï¼š[Rules (commitlint.js.org)](https://commitlint.js.org/#/reference-rules?id=rules)

è§„åˆ™ç”±åç§°å’Œé…ç½®æ•°ç»„ç»„æˆï¼š
<é…ç½®åç§°>: [<è­¦æŠ¥çº§åˆ«>, <æ˜¯å¦å¯ç”¨>, <è§„åˆ™å¯¹åº”çš„å€¼>]

- è­¦æŠ¥çº§åˆ«
  - 0 æ— æç¤º disable
  - 1 è­¦å‘Š warning
  - 2 é”™è¯¯ error
- æ˜¯å¦å¯ç”¨
  - always å¯ç”¨
  - never ç¦ç”¨
- è§„åˆ™å¯¹åº”çš„å€¼ï¼šæŸ¥çœ‹å®˜æ–¹æ–‡æ¡£è¿›è¡Œé…ç½®

```javascript
// è¿™é‡Œæ˜¯é€šä¿—çš„è§£é‡Š è¯¦æƒ…è¯·å‰å¾€å®˜æ–¹æ–‡æ¡£æŸ¥é˜…
module.exports = {
	ignores: [commit => commit.includes('init')],
	extends: ['@commitlint/config-conventional'],
	rules: {
		// ä¿¡æ¯ä»¥ç©ºæ ¼å¼€å¤´
		'body-leading-blank': [2, 'always'],
		'footer-leading-blank': [2, 'always'],
		// ä¿¡æ¯æœ€å¤§é•¿åº¦
		'header-max-length': [2, 'always', 108],
		// ä¿¡æ¯ä¸èƒ½æœªç©º
		'subject-empty': [2, 'never'],
		// ä¿¡æ¯ç±»å‹ä¸èƒ½æœªç©º
		'type-empty': [2, 'never'],
		// æäº¤ä¿¡æ¯çš„ç±»å‹ ä¸‹æ–‡æœ‰ä»‹ç»
		'type-enum': [
			2,
			'always',
			[
				'feat',
				'fix',
				'perf',
				'style',
				'docs',
				'test',
				'refactor',
				'build',
				'ci',
				'chore',
				'revert',
				'wip',
				'workflow',
				'types',
				'release',
				'temp'
			]
		]
	}
};
```

**æäº¤ä¿¡æ¯çš„ç±»å‹ä¸€èˆ¬æœ‰å¦‚ä¸‹è§„èŒƒ**ï¼ˆå¯æ ¹æ®å›¢é˜Ÿä¹ æƒ¯è¿›è¡Œæ›´æ”¹ï¼‰ï¼š

- feat : å¢åŠ ä¸€ä¸ªæ–°ç‰¹æ€§
- fix : ä¿®å¤ä¸€ä¸ª bug
- perf : æ›´æ”¹ä»£ç ä»¥æé«˜æ€§èƒ½
- build : æ›´æ”¹æ„å»ºç³»ç»Ÿå’Œå¤–éƒ¨ä¾èµ–é¡¹ï¼ˆå¦‚å°† gulp æ”¹ä¸º webpackï¼Œæ›´æ–°æŸä¸ª npm åŒ…ï¼‰
- ci : å¯¹ CI é…ç½®æ–‡ä»¶å’Œè„šæœ¬çš„æ›´æ”¹
- docs : ä»…ä»…ä¿®æ”¹æ–‡æ¡£è¯´æ˜
- refactor : ä»£ç é‡æ„æ—¶ä½¿ç”¨
- style : ä¸å½±å“ä»£ç å«ä¹‰çš„æ”¹åŠ¨ï¼Œä¾‹å¦‚å»æ‰ç©ºæ ¼ã€æ”¹å˜ç¼©è¿›ã€å¢åˆ åˆ†å·
- test : å¢åŠ æ–°çš„æµ‹è¯•åŠŸèƒ½æˆ–æ›´æ”¹åŸæœ‰çš„æµ‹è¯•æ¨¡å—
- temp: ä¸´æ—¶çš„æäº¤

![git .png](https://cdn.nlark.com/yuque/0/2023/png/207857/1698137772303-183e2c80-9141-4266-9ee4-d6d60ce2387e.png#averageHue=%23f2efec&clientId=u67e2578a-a5a2-4&from=paste&height=454&id=uef5b649e&originHeight=727&originWidth=544&originalType=binary&ratio=1.600000023841858&rotation=0&showTitle=false&size=187446&status=done&style=none&taskId=u9f702605-9878-4ac6-aa87-fb72cfeb12d&title=&width=339.99999493360525)

### é’©å­é…ç½®

ä½¿ç”¨ husky é…ç½®ä¸€ä¸ª commit-msg é’©å­

```bash
# .huskyä¸‹æ–°å»ºcommit-msgæ–‡ä»¶ å¾€é‡Œé¢åŠ å…¥
# --no-install ä»£è¡¨å¼ºåˆ¶ä½¿ç”¨æœ¬åœ°æ¨¡å—
npx --no-install commitlint --edit $1
```

é…ç½®å®Œæˆåæˆ‘ä»¬å°±å¯ä»¥åœ¨ git commit æ—¶è¿›è¡Œä¿¡æ¯çš„è§„èŒƒ
æˆ‘ä»¬éœ€è¦æŒ‰ç…§ä»¥ä¸‹æ ¼å¼è¿›è¡Œæäº¤ï¼š

```bash
# git commit -m "ç±»å‹: ä¿¡æ¯"
# æ–°å¢åŠŸèƒ½ç¤ºä¾‹
git commit -m "feat: æ–°å¢ç”¨æˆ·ç™»å½•åŠŸèƒ½"
# ä¿®å¤Bugç¤ºä¾‹
git commit -m "fix: ä¿®å¤é¦–é¡µç”¨æˆ·å¤´åƒä¸æ˜¾ç¤ºé—®é¢˜"
```
